name: Update Kamal Accessories

on:
  workflow_dispatch:
  schedule:
    # Run every Sunday at 8:05 AM UTC
    - cron: "5 8 * * 0"

jobs:
  update-accessories:
    name: Check and Update Accessories
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Update Kamal accessories
        uses: ./
        with:
          config-dir: config
          mode: update-all
          create-pr: true
          pr-branch: update/kamal-accessories
          pr-title: "chore: bump Kamal accessories versions"
          pr-body: "Automated update of Kamal accessories to their latest versions from Docker Hub."
          pr-labels: "dependencies,automation"
          github-token: ${{ secrets.GITHUB_TOKEN }}
